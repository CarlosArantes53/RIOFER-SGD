{% extends "layout.html" %}

{% block title %}Pedidos{% endblock %}

{% block content %}
    
    <table class="table-users">
        <thead>
            <tr>
                <th>Cliente</th>
                <th>Nome do Cliente</th>
                <th>Tipo de Entrega</th>
                <th>Cidade</th>
                <th>Localiza√ß√£o</th>
                <th>Status</th>
                <th>A√ß√µes</th>
            </tr>
        </thead>
        <tbody>
            {% for pedido in pedidos %}
            <tr>
                <td>{{ pedido.CardCode }}</td>
                <td>{{ pedido.CardName }}</td>
                <td>
                    {% if pedido['U_TU_QuemEntrega'] == '01' %}
                        üöö Entrega
                    {% elif pedido['U_TU_QuemEntrega'] == '02' %}
                        üì¶ Retirada
                    {% else %}
                        {{ pedido['U_TU_QuemEntrega'] }}
                    {% endif %}
                </td>
                <td>{{ pedido.U_GI_Cidade }}</td>
                <td>{{ pedido.Localizacao }}</td>
                <td>{{ pedido.Status }}</td>
                <td>
                    <div class="action-buttons">
                        <a href="{{ url_for('pedidos.visualizar_picking', abs_entry=pedido.AbsEntry, localizacao=pedido.Localizacao) }}" class="btn">Visualizar</a>
                        
                        {% if 'Em separa√ß√£o' in pedido.Status and pedido.UserInSeparation == session.user['email'] %}
                             <a href="{{ url_for('pedidos.separar_picking', abs_entry=pedido.AbsEntry, localizacao=pedido.Localizacao) }}" class="btn">Continuar Separa√ß√£o</a>
                        {% elif 'Em separa√ß√£o' in pedido.Status %}
                            <button class="btn" disabled>Em separa√ß√£o</button>

                        {% elif pedido.Status == 'Aguardando Packing' %}
                            <a href="{{ url_for('packing.iniciar_packing', abs_entry=pedido.AbsEntry, localizacao=pedido.Localizacao) }}" class="btn">Iniciar Packing</a>
                        
                        {% elif pedido.Status == 'Packing Finalizado' %}
                             <button class="btn" disabled>Conclu√≠do</button>
                        
                        {% else %} {# Caso padr√£o para Status == 'Pendente' #}
                            <a href="{{ url_for('pedidos.iniciar_separacao', abs_entry=pedido.AbsEntry, localizacao=pedido.Localizacao) }}" class="btn">Iniciar Separa√ß√£o</a>
                        {% endif %}
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}