{% extends "layout.html" %}

{% block title %}Packing do Pedido {{ abs_entry }} - {{ localizacao }}{% endblock %}

{% block content %}
    <h1>Packing do Pedido {{ abs_entry }} - Localização {{ localizacao }}</h1>
    <form method="post">
        
        {% for pacote in pacotes %}
        <div class="pedido-card" style="margin-bottom: 20px; cursor: default;">
            <div class="card-header" style="padding-bottom: 0.5rem; margin-bottom: 1rem;">
                <h3 class="card-title">Pacote {{ pacote.id }}</h3>
                <div class="card-meta">
                   <span><strong>Peso Registrado:</strong> {{ "%.2f"|format(pacote.peso_original) }} kg</span>
                </div>
            </div>

            <ul>
                {% for item in pacote.itens %}
                    <li>{{ item.ItemName }} ({{ item.ItemCode }}) - Qtd: {% if item.UomCode == 'KG' or item.UomCode == 'METROS' %}{{ "%.2f"|format(item.Quantity|float) }}{% else %}{{ "%.0f"|format(item.Quantity|float) }}{% endif %} {{ item.UomCode }}</li>
                {% endfor %}
            </ul>
            
            <div class="form-grid" style="margin-top: 1.5rem; align-items: center;">
                <div class="input-group">
                    <label for="peso_pacote_{{ pacote.id }}"><strong>Peso Conferido (kg):</strong></label>
                    <input type="number" step="any" id="peso_pacote_{{ pacote.id }}" name="peso_pacote_{{ pacote.id }}" required>
                </div>

                <div class="input-group" style="padding-top: 1.5rem; display: flex; align-items: center; gap: 10px;">
                     <input type="checkbox" id="confirm_pacote_{{ pacote.id }}" name="confirm_pacote_{{ pacote.id }}" value="1" style="width: auto; transform: scale(1.5);">
                     <label for="confirm_pacote_{{ pacote.id }}" style="margin-bottom: 0;">Confirmar Pacote</label>
                </div>
            </div>
        </div>
        {% endfor %}

        <div style="margin-top: 30px;">
            <button type="submit" class="btn">Finalizar Packing da Localização</button>
            <a href="{{ url_for('pedidos.listar_pedidos') }}" class="btn btn-secondary">Cancelar</a>
        </div>
    </form>
{% endblock %}